<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>For My AasuðŸ’“ðŸ’“</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', sans-serif;
    }

    body {
      height: 100vh;
      background: linear-gradient(to bottom, #0f0c29, #302b63, #24243e);
      overflow: hidden;
      color: #fff;
    }

    canvas {
      position: fixed;
      top: 0;
      left: 0;
      z-index: 0; /* keep animation behind text for better readability on mobile */
      pointer-events: none;
    }

    .text {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 24px;
      z-index: 2;
    }

    .text-content {
      max-width: 900px;
      animation: fadeIn 2s ease;
      background: rgba(255,255,255,0.03);
      border: 2px solid rgba(255,255,255,0.06);
      padding: 22px;
      border-radius: 16px;
      margin: 12px;
    }

    h1 {
      font-size: 2.8rem;
      margin-bottom: 24px;
      color: #ffb7c5;
      text-shadow: 0 0 20px rgba(255,183,197,0.4);
    }

    p {
      font-size: 1.15rem;
      line-height: 1.9;
      opacity: 0.95;
      text-shadow: 0 0 15px rgba(0,0,0,0.6);
    }

    .signature {
      margin-top: 30px;
      font-size: 1.3rem;
      color: #ffd1dc;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .actions{margin-top:28px;display:flex;gap:18px;justify-content:center;align-items:center}
  #yesBtn{padding:16px 28px;font-size:1.15rem;border-radius:999px;border:none;cursor:pointer;background:linear-gradient(135deg,#ffb7c5,#ffd1dc);color:#3b0f1e;box-shadow:0 10px 30px rgba(255,183,197,.5);transform:scale(1.08)}
  #noBtn{padding:8px 14px;font-size:.8rem;border-radius:999px;border:1px solid rgba(255,255,255,.4);background:transparent;color:#fff;opacity:.6;cursor:pointer}
  #yesBtn:hover{transform:scale(1.15)}
  #noBtn:hover{opacity:.85}
  
  /* Responsive adjustments for smaller screens (phones) */
  @media (max-width: 480px) {
    h1 { font-size: 1.8rem; }
    p { font-size: 1rem; line-height:1.6 }
    .text { padding: 12px; }
    .text-content { padding: 14px; margin: 8px; border-width:1px; }
    .actions { flex-direction: column; gap:12px; }
    #yesBtn { width: 100%; padding:12px 16px; font-size:1rem; }
    #noBtn { width: 100%; padding:10px 14px; font-size:0.95rem; }
    canvas { /* ensure canvas won't cause horizontal overflow */ max-width:100vw; }
  }
</style>
</head>
<body>
  <canvas id="sakura"></canvas>

  <div class="text">
    <div class="text-content">
      <h1>For My Aasu ðŸ’“</h1>
      <p>
        Aasuâ€¦ maine tumhe itna hurt kiya ki tumhari khamoshi
        meri sabse badi saza ban gayi.
        <br /><br />
        Aaj jab tum mujhse door ho,
        tab samajh aaya ki tum meri zindagi ka sirf hissa nahi,
        balki meri poori zarurat ho.
        <br /><br />
        Main yeh wada nahi karta ki main perfect hoon,
        par yeh wada zaroor karta hoon
        ki main tumhari kadar karna seekh chuka hoon.
        <br /><br />
        Agar abhi bhi kahin dil ke kone mein
        mere liye thodi si jagah bachi ho,
        toh main poori zindagi us jagah ko sambhal ke rakhunga.
        <br /><br />
        Main bas ek mauka maang raha hoon â€”
        sab kuch theek karne ka nahi,
        balki dheere-dheere phir se tumhara bharosa jeetne ka.
        Agar tum ek kadam bhi meri taraf badh pao,
        toh main har kadam sirf tumhari izzat aur khushi ke liye rakhunga.
      </p>
      <div class="signature">â€” Tumhara Vedu</div>
      <div class="actions">
        <button id="yesBtn">Give me one last chance</button>
        <button id="noBtn">No</button>
      </div>
      <!-- Audio element and user-visible status (single element) -->
      <audio id="bgAudio" src="take%201.mp3" preload="auto" loop playsinline autoplay muted></audio>
      <div id="audioStatus" aria-live="polite" style="margin-top:12px;color:#ffd1dc;font-size:.95rem;opacity:.95"></div>
    </div>
  </div>

  <!-- Fullscreen tap-to-unmute overlay (required on many mobile browsers to enable audible playback) -->
  <div id="tapOverlay" style="position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:9999;background:linear-gradient(180deg,rgba(0,0,0,0.6),rgba(0,0,0,0.4));backdrop-filter:blur(4px);">
    <div style="text-align:center;color:#fff;padding:20px;max-width:360px;margin:0 16px;border-radius:12px;">
      <h2 style="margin-bottom:8px;font-size:1.2rem;color:#ffd1dc">Tap to enable music</h2>
      <p style="margin-bottom:14px;opacity:.9">Tap anywhere to allow background music to play. This is required by mobile browser policies.</p>
      <button id="overlayBtn" style="padding:12px 18px;border-radius:10px;border:none;background:#ffb7c5;color:#3b0f1e;font-weight:700;cursor:pointer">Tap to Play</button>
    </div>
  </div>

  <script>
    const canvas = document.getElementById('sakura');
    const ctx = canvas.getContext('2d');

    let w = canvas.width = window.innerWidth;
    let h = canvas.height = window.innerHeight;

    const hearts = [];

    function createHeart() {
      return {
        x: Math.random() * w,
        y: Math.random() * h - h,
        size: Math.random() * 10 + 8,
        speed: Math.random() * 2 + 1,
        drift: Math.random() * 1 - 0.5,
        opacity: Math.random() * 0.5 + 0.4
      };
    }

    for (let i = 0; i < 120; i++) hearts.push(createHeart());

    function drawHeart(x, y, size, opacity) {
      ctx.save();
      ctx.translate(x, y);
      ctx.scale(size / 16, size / 16);
      ctx.beginPath();
      ctx.moveTo(0, 4);
      ctx.bezierCurveTo(0, -4, -8, -4, -8, 2);
      ctx.bezierCurveTo(-8, 8, 0, 12, 0, 16);
      ctx.bezierCurveTo(0, 12, 8, 8, 8, 2);
      ctx.bezierCurveTo(8, -4, 0, -4, 0, 4);
      ctx.closePath();
      ctx.fillStyle = `rgba(255,183,197,${opacity})`;
      ctx.fill();
      ctx.restore();
    }

    function animate() {
      ctx.clearRect(0, 0, w, h);

      hearts.forEach(hd => {
        drawHeart(hd.x, hd.y, hd.size, hd.opacity);
        hd.y += hd.speed;
        hd.x += hd.drift;

        if (hd.y > h) {
          hd.y = -20;
          hd.x = Math.random() * w;
        }
      });

      requestAnimationFrame(animate);
    }

    animate();

    window.addEventListener('resize', () => {
      w = canvas.width = window.innerWidth;
      h = canvas.height = window.innerHeight;
    });
    const msg = document.querySelector('.text-content p');
    const yes = document.getElementById('yesBtn');
    const no = document.getElementById('noBtn');
    let tries = 0;

    yes.addEventListener('click',()=>{
      msg.innerHTML += '<br /><br /><strong>Thank you for choosing hope.</strong> Main sabr se, izzat se, aur dil se tumhara saath nibhaunga.';
      yes.innerText = 'I won\'t waste this chance';
      yes.style.transform='scale(1.25)';
    });

    no.addEventListener('click',()=>{
      tries++;
      const lines = [
        'Main samajhta hoon tumhara dard. Par ek mauka mujhe yeh dikhane de ki main badal chuka hoon.',
        'Yeh sirf maafi nahi haiâ€”yeh zimmedari hai jo main poori zindagi uthane ko tayyar hoon.',
        'Agar aaj nahi, toh kal. Main yahin rahungaâ€”tumhari pace par.'
      ];
      msg.innerHTML += `<br /><br /><em>${lines[Math.min(tries-1, lines.length-1)]}</em>`;
      yes.style.transform = `scale(${1.15 + tries*0.08})`;
      no.style.opacity = Math.max(.2, .6 - tries*0.15);
    });

    // --- Audio play diagnostics and autoplay attempt ---
    const bgAudio = document.getElementById('bgAudio');
    const audioStatus = document.getElementById('audioStatus');

    function reportAudioStatus(text) {
      console.log('[AudioStatus]', text);
      if (audioStatus) audioStatus.textContent = text;
    }

    async function tryPlayAudio() {
      if (!bgAudio) return reportAudioStatus('No audio element found.');
      // ensure reasonable volume
      try {
        bgAudio.volume = 0.8;
            // Attempt to play (may be blocked if not a user gesture)
            await bgAudio.play();
            reportAudioStatus('Audio is playing.');
      } catch (err) {
        // Most likely an autoplay policy or network error. Show helpful info to user and console.
        console.warn('Audio play failed:', err);
        let msgText = 'Unable to start audio automatically.';
        if (err && err.name) msgText += ` (${err.name})`;
        // Check element error state (e.g., 404)
        if (bgAudio.error) {
          const code = bgAudio.error.code;
          msgText += ` â€” media error code ${code}`;
        }
          msgText += ' Tap the screen or the "Give me one last chance" button to play.';
        reportAudioStatus(msgText);
      }
    }

    // Try to play when the user clicks the Yes button (explicit user gesture)
    yes.addEventListener('click', () => {
      tryPlayAudio();
    });

    // Also add a single-use global click to attempt play on first user interaction
    function firstInteractionPlay() {
      tryPlayAudio();
      window.removeEventListener('click', firstInteractionPlay);
    }
    window.addEventListener('click', firstInteractionPlay, { once: true });

    // Try to autoplay unmuted on load. If blocked, fall back to muted autoplay (silent) so the element is playing.
    window.addEventListener('load', async () => {
      if (!bgAudio) return;
      // First confirm the audio file is reachable (helps diagnose 404/CORS)
      const audioSrc = bgAudio.getAttribute('src');
      try {
        // try a HEAD request; if server doesn't support HEAD, fallback to GET with range
        const head = await fetch(audioSrc, { method: 'HEAD' });
        if (!head.ok) throw new Error('HEAD failed: ' + head.status);
      } catch (eHead) {
        try {
          const get = await fetch(audioSrc, { method: 'GET', headers: { Range: 'bytes=0-1' } });
          if (!get.ok) throw new Error('GET failed: ' + get.status);
        } catch (eGet) {
          console.warn('Audio file fetch check failed:', eHead, eGet);
          reportAudioStatus('Audio file not reachable (404/CORS). Check file path or server.');
          return; // don't continue trying to play if resource isn't reachable
        }
      }

      // Try an audible autoplay first (likely blocked on mobile). If blocked, start muted autoplay so audio element is playing in background.
      try {
        bgAudio.muted = false;
        bgAudio.volume = 0.8;
        await bgAudio.play();
        reportAudioStatus('Autoplay started and is audible.');
      } catch (err) {
        console.log('Unmuted autoplay blocked, attempting muted autoplay fallback:', err);
        try {
          bgAudio.muted = true;
          bgAudio.volume = 0.8;
          await bgAudio.play();
          reportAudioStatus('Autoplay started muted (browser blocked audible autoplay).');
        } catch (e2) {
          console.log('Muted autoplay also blocked:', e2);
          reportAudioStatus('Audio did not autoplay. A user interaction is required to start sound.');
        }
      }
    });

    // Overlay logic: when user taps overlay, unmute and play audible audio, then hide overlay
    const tapOverlay = document.getElementById('tapOverlay');
    const overlayBtn = document.getElementById('overlayBtn');

    async function activateAudioFromGesture() {
      if (!bgAudio) return;
      try {
        bgAudio.muted = false;
        bgAudio.volume = 0.85;
        await bgAudio.play();
        reportAudioStatus('Audio unmuted and playing.');
      } catch (err) {
        console.warn('Play after gesture failed:', err);
        reportAudioStatus('Could not start audible audio. It may still require interaction.');
      }
      if (tapOverlay) tapOverlay.style.display = 'none';
      window.removeEventListener('click', activateAudioFromGesture);
    }

    // Clicking the overlay button or anywhere on the overlay will try to enable audio
    if (overlayBtn) overlayBtn.addEventListener('click', activateAudioFromGesture);
    if (tapOverlay) tapOverlay.addEventListener('click', activateAudioFromGesture);
    // Also allow a general first interaction anywhere to activate audio
    window.addEventListener('click', activateAudioFromGesture, { once: true });

</script>
</body>
</html>
